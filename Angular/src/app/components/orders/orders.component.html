<div>
    <p-tabs [value]="tab">
        <p-tablist>
            <p-tab [value]="'commands'" (click)="openCommands()">{{'orders.commands_tab' | translate}}</p-tab>
            <p-tab [value]="'contracts'" (click)="openContracts()">{{'orders.contracts_tab' | translate}}</p-tab>
        </p-tablist>
        <p-tabpanels>
            <p-tabpanel [value]="'commands'">
                <p-table *ngIf="myOrders.length > 0" [value]="myOrders" [tableStyle]="{'width': '100%'}">
                    <ng-template #header>
                        <tr>
                            <th>
                                {{'orders.name_column' | translate}}
                            </th>
                            <th>
                                <div class="right-cell">
                                    {{'orders.price_column' | translate}}
                                </div>
                            </th>
                            <th>
                                <div class="center-cell">
                                    {{'orders.status_column' | translate}}
                                </div>
                            </th>
                            <th>
                                {{'orders.target_date_column' | translate}}
                            </th>
                            <th>
                                {{'orders.printer_column' | translate}}
                            </th>
                            <th>
                                {{'orders.rating_column' | translate}}
                            </th>
                            <th>
                                {{'orders.actions_column' | translate}}
                            </th>
                        </tr>
                    </ng-template>
                    <ng-template #body let-order>
                        <tr>
                            <td>{{order.offer.request.name}}</td>
                            <td>
                                <div class="right-cell">
                                    {{order.offer.price | currency}}
                                </div>
                            </td>
                            <td>
                                <div class="center-cell">
                                    <span class="status-tag" [ngStyle]="{'background-color': statusColorRef[order.orderStatus.at(-1).statusName || 0]}">
                                        <p class="w-full">{{"status." + order.orderStatus.at(-1).statusName | translate}}</p>
                                    </span>
                                </div>
                            </td>
                            <td>{{order.offer.targetDate | date:'fullDate'}}</td>
                            <td>
                                <div class="h-td-table">
                                    <p-avatar label="" size="large" shape="circle" *ngIf="order.offer.printerUser.user.profilePictureUrl" image="{{order.offer.printerUser.user.profilePictureUrl}}"></p-avatar>
                                    <p>{{order.offer.printerUser.user.username}}</p>
                                </div>
                                
                            </td>
                            <td>
                                <div *ngIf="order.review" class="h-td-table">
                                    <p>{{order.review?.rating}}</p>
                                    <i class="pi pi-star-fill"></i>
                                </div>
                                <p *ngIf="!order.review">{{'orders.no_review_message' | translate}}</p>
                            </td>
                            <td>
                                <p-button
                                    icon="pi pi-arrow-right"
                                    title="{{'orders.action_button_label' | translate}}"
                                    routerLink="/orders/view/{{ order.id }}"
                                ></p-button>
                            </td>
                        </tr>
                    </ng-template>
                </p-table>
                <div
                    *ngIf="myOrders.length == 0"
                    class="empty-message"
                    style="width: 100%; height: 100%;"
                    >
                    <i class="pi pi-inbox text-6xl text-gray-400"></i>
                    <p class="text-xl font-semibold text-gray-500 mt-2">
                        {{'orders.no_commands_message' | translate}}
                    </p>
                </div>
            </p-tabpanel>
            <p-tabpanel [value]="'contracts'">
                <p-table *ngIf="makeOrders.length > 0" [value]="makeOrders" [tableStyle]="{'width': '100%'}">
                    <ng-template #header>
                        <tr>
                            <th>
                                {{'orders.name_column' | translate}}
                            </th>
                            <th>
                                <div class="right-cell">
                                    {{'orders.price_column' | translate}}
                                </div>
                            </th>
                            <th>
                                <div class="center-cell">
                                    {{'orders.status_column' | translate}}
                                </div>
                            </th>
                            <th>
                                {{'orders.target_date_column' | translate}}
                            </th>
                            <th>
                                {{'orders.consumer_column' | translate}}
                            </th>
                            <th>
                                {{'orders.rating_column' | translate}}
                            </th>
                            <th>
                                {{'orders.actions_column' | translate}}
                            </th>
                        </tr>
                    </ng-template>
                    <ng-template #body let-order>
                        <tr>
                            <td>{{order.offer.request.name}}</td>
                            <td>
                                <div class="right-cell">
                                    {{order.offer.price | currency}}
                                </div>
                            </td>
                            <td>
                                <div class="center-cell">
                                    <span class="status-tag" [ngStyle]="{'background-color': statusColorRef[order.orderStatus.at(-1).statusName || 0]}">
                                        <p class="w-full">{{"status." + order.orderStatus.at(-1).statusName | translate}}</p>
                                    </span>
                                </div>
                            </td>
                            <td>{{order.offer.targetDate | date:'fullDate'}}</td>
                            <td>
                                <div class="h-td-table">
                                    <p-avatar label="" size="large" shape="circle" *ngIf="order.offer.request.user.profilePictureUrl" image="{{order.offer.request.user.profilePictureUrl}}"></p-avatar>
                                    <p>{{order.offer.request.user.username}}</p>
                                </div>
                                
                            </td>
                            <td>
                                <div *ngIf="order.review" class="h-td-table">
                                    <p>{{order.review?.rating}}</p>
                                    <i class="pi pi-star-fill"></i>
                                </div>
                                <p *ngIf="!order.review">{{'orders.no_review_message' | translate}}</p>
                            </td>
                            <td>
                                <p-button
                                    icon="pi pi-arrow-right"
                                    title="{{'orders.action_button_label' | translate}}"
                                    routerLink="/orders/view/{{ order.id }}"
                                ></p-button>
                            </td>
                        </tr>
                    </ng-template>
                </p-table>
                <div
                    *ngIf="makeOrders.length == 0"
                    class="empty-message"
                    style="width: 100%; height: 100%;"
                    >
                    <i class="pi pi-inbox text-6xl text-gray-400"></i>
                    <p class="text-xl font-semibold text-gray-500 mt-2">
                        {{'orders.no_contract_message' | translate}}
                    </p>
                </div>
            </p-tabpanel>
        </p-tabpanels>
    </p-tabs>
</div>

